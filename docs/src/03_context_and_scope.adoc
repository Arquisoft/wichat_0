ifndef::imagesdir[:imagesdir: ../images]

[[section-context-and-scope]]
== Context and Scope


ifdef::arc42help[]
[role="arc42help"]
****
.Contents
Context and scope - as the name suggests - delimits your system (i.e. your scope) from all its communication partners
(neighboring systems and users, i.e. the context of your system). It thereby specifies the external interfaces.

If necessary, differentiate the business context (domain specific inputs and outputs) from the technical context (channels, protocols, hardware).

.Motivation
The domain interfaces and technical interfaces to communication partners are among your system's most critical aspects. Make sure that you completely understand them.

.Form
Various options:

* Context diagrams
* Lists of communication partners and their interfaces.


.Further Information

See https://docs.arc42.org/section-3/[Context and Scope] in the arc42 documentation.

****
endif::arc42help[]

=== Business Context

ifdef::arc42help[]
[role="arc42help"]
****
.Contents
Specification of *all* communication partners (users, IT-systems, ...) with explanations of domain specific inputs and outputs or interfaces.
Optionally you can add domain specific formats or communication protocols.

.Motivation
All stakeholders should understand which data are exchanged with the environment of the system.

.Form
All kinds of diagrams that show the system as a black box and specify the domain interfaces to communication partners.

Alternatively (or additionally) you can use a table.
The title of the table is the name of your system, the three columns contain the name of the communication partner, the inputs, and the outputs.

****
endif::arc42help[]

**<Diagram or Table>**

**<optionally: Explanation of external domain interfaces>**

=== Contexto Técnico

ifdef::arc42help[]
[role="arc42help"]
****
.Contenido
Interfaces técnicas (canales y medios de transmisión) que juntan el sistema con su entorno. Además un mapeo del dominio especifico de entrada/salida a los canales, es decir una explicación de qué entrada salida usa cada canal.

.Motivación
Muchos stakeholders toman decisiones arquitectónicas basadas en las interfaces técnicas entre el sistema y su contexto. En especial, los diseñadores de hardware o infraestructura deciden estas interfaces técnicas.

.Forma
E.g. Diagrama UML de despliegue describiendo canales con los sistemas vecinos,
junto a una tabla de mapeo mostrando las relaciones entre canales y la entrada/salida.

****
endif::arc42help[]

==== Diagrama de Despliegue

[plantuml,diagrama-despliegue,png]
----
@startuml
skinparam cloudColor LightBlue
skinparam databaseColor LightGreen
skinparam nodeColor LightGray

cloud "Usuario" {
    [Navegador Web]
}

node "WebApp" {
    [Aplicación React]
}

node "Backend (Servidor)" {
    [API Node.js]
    [Servicio LLM]
    [Servicio Autenticación (authservice)]
    [Servicio Usuario (userservice)]
}

database "WikiData" {
    [API WikiData] 
}

database "MongoDB" {
    [Base de Datos de Usuarios]
}

node "Monitorización" {
    [Prometheus]
    [Grafana]
}


[Navegador Web] --> [Aplicación React] : HTTP Request
[Aplicación React] --> [API Node.js] : API Request (REST)
[API Node.js] --> [Servicio Autenticación (authservice)] : Solicita autenticación de usuario
[API Node.js] --> [Servicio LLM] : Solicitar pista
[API Node.js] --> [Servicio Usuario (userservice)] : Inserta/Consulta datos
[API WikiData] --> [API Node.js] : Envía imagen y respuesta
[API WikiData] --> [Servicio LLM] : Envía pistas
[Servicio LLM] --> [API Node.js] : Responder con pista
[API Node.js] --> [Aplicación React] : Enviar info al usuario
[Servicio Autenticación (authservice)] --> [Base de Datos de Usuarios] : Verifica LogIn
[Servicio Usuario (userservice)] --> [Base de Datos de Usuarios] : Inserta/Consulta datos


[Prometheus] --> [API Node.js] : Recolectar métricas
[Grafana] --> [Prometheus] : Visualización de métricas

@enduml
----

==== Explicación de Interfaces Técnicas

===== API Node.js
API que hace de enlace entre las distintas partes de la aplicación

===== Aplicación React
Aplicación web hecha con React que aporta al usuario una interfaz con la que interactuar y por medio de la cual hacer las peticiones
correspondientes al backend

===== Servicio de Autenticación
Interfaz que se comunica con la base de datos de usuarios a fin de comprobar si los datos introducidos de inicio de sesión
se corresponden con un usuario relaciones

===== Servicio de Usuario
Interfaz que se comunica con la base de datos de usuarios a fin de consultar y actualizar la información referente a los usuarios y
sus partidas

===== Servicio LLM
Servicio que, por medio de las pistas obtenidas de WikiData, procesará y responderá a las pistas que pida el usuario

===== API WikiData
API del servicio web WikiData que aportará a la aplicación las imágenes para el juego, las respuestas a las mismas y las
pistas que el LLM utilizará para responder a los usuarios

===== Prometheus
Interfaz que almacena en su base de datos optimizada las métricas traidas de la API Node.js

===== Grafana
Interfaz que por medio de consultas a Prometheus, muestra gráficamente los datos obtenidos de las mismas

==== Mapeo de Canales de Entrada/salida

[options="header",cols="1,2,2"]
|===
| Canal | Entrada | Salida
| Navegador Web -> Aplicación React | Aplicación React recibe peticiones HTTP del usuario indicando sus acciones | Responde con información a través de la interfaz.
| Aplicación React -> API Node.js | API Node.js recibe peticiones REST para obtener datos como imágenes y respuestas o solicitar operaciones como iniciar sesión | API Node.js procesa la solicitud y devuelve una respuesta con la información solicitada.
| API Node.js -> Servicio Autenticación | Servicio de Autenticación recibe datos de inicio de sesión de un usuario | Responde con la comprobación de si el usuario existe.
| Servicio Autenticación -> Base de Datos de Usuarios | La Base de Datos recibe una consulta SELECT en la que comprueba si cierto usuario existe | La base de datos devuelve el usuario en caso de que exista.
| API Node.js -> Servicio Usuario | Servicio de Usuario recibe consultas o inserciones de datos | Responde con los datos solicitados o la confirmación de la operación.
| API Node.js -> Servicio LLM | Servicio LLM recibe solicitudes de pistas | Responde con la pista generada por el modelo.
| API Node.js -> API WikiData | La API Node.js consulta la API WikiData para obtener información adicional | La API WikiData responde con la imagen o la respuesta solicitada.
| Prometheus -> API Node.js | Prometheus recolecta métricas de la API Node.js | La API Node.js responde con las métricas solicitadas.
| Grafana -> Prometheus | Grafana solicita métricas a Prometheus para visualizar | Prometheus responde con las métricas para la visualización.
|===

